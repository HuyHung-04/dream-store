<div *ngIf="hoaDonData; else noData" class="invoice-container">
  <!-- MÃ£ hÃ³a Ä‘Æ¡n (CÄƒn pháº£i) -->
  <div class="invoice-header">
    <h3>Chi tiáº¿t HÃ³a ÄÆ¡n</h3>
    <p class="invoice-code"><strong>MÃ£ hÃ³a Ä‘Æ¡n:</strong> {{ hoaDonData.ma }}</p>
  </div>

   <!-- Náº¿u tráº¡ng thÃ¡i hÃ³a Ä‘Æ¡n lÃ  5 (ÄÆ¡n hÃ ng Ä‘Ã£ há»§y), chá»‰ hiá»ƒn thá»‹ thÃ´ng bÃ¡o nÃ y -->
   <div *ngIf="hoaDonData.trangThai == 5">
    <div class="cancelHoaDon">
      <p><i class="bi bi-x-circle"></i> ÄÆ¡n hÃ ng Ä‘Ã£ bá»‹ há»§y</p>
      <small>{{ hoaDonData.ngayHoanThanh || '---' }}</small>
    </div>
  </div>

  <div class="status-tracker" *ngIf="hoaDonData.trangThai != 5">
    <div class="status-step" [class.active]="hoaDonData.trangThai == 1">
      <div class="status-icon">ğŸ“„</div>
      <p>Chá» xÃ¡c nháº­n</p>
      <small>{{ hoaDonData.ngayTao }}</small>
    </div>

    <div class="status-line" [class.active]="hoaDonData.trangThai == 2"></div>

    <div class="status-step" [class.active]="hoaDonData.trangThai == 2">
      <div class="status-icon">âœ”ï¸</div>
      <p>ÄÃ£ Ä‘Æ°á»£c xÃ¡c nháº­n</p>
      <small>{{ hoaDonData.ngayXacNhan || '---' }}</small>
    </div>

    <div class="status-line" [class.active]="hoaDonData.trangThai == 3"></div>

    <div class="status-step" [class.active]="hoaDonData.trangThai == 3">
      <div class="status-icon">ğŸšš</div>
      <p>Äang giao hÃ ng</p>
      <small>{{ hoaDonData.ngayGiao || '---' }}</small>
    </div>

    <div class="status-line" [class.active]="hoaDonData.trangThai == 4"></div>

    <div class="status-step" [class.active]="hoaDonData.trangThai == 4">
      <div class="status-icon">ğŸ“¦</div>
      <p>Giao hÃ ng thÃ nh cÃ´ng</p>
      <small>{{ hoaDonData.ngayNhan || '---' }}</small>
    </div>

    
    <!-- <div class="status-line" [class.active]="hoaDonData.trangThai === 5"></div>
    
        <div class="status-step" [class.active]="hoaDonData.trangThai === 5">
          <div class="status-icon">â­</div>
          <p>ÄÆ¡n HÃ ng ÄÃ£ HoÃ n ThÃ nh</p>
          <small>{{ hoaDonData.ngayHoanThanh || '---' }}</small>
        </div> -->
  </div>
  <!-- Äá»‹a chá»‰ nháº­n hÃ ng -->
  <section class="section">
    <h3>Äá»‹a chá»‰ nháº­n hÃ ng</h3>
    <p><strong>TÃªn ngÆ°á»i nháº­n:</strong> {{ hoaDonData.tenNguoiNhan }}</p>
    <p><strong>Sá»‘ Ä‘iá»‡n thoáº¡i:</strong> {{ hoaDonData.sdtNguoiNhan }}</p>
    <p><strong>Äá»‹a chá»‰:</strong> {{ hoaDonData.diaChiNhanHang }}</p>
  </section>

  <!-- Chi tiáº¿t hÃ³a Ä‘Æ¡n -->
  <section class="section" *ngIf="chiTietHoaDonData?.length > 0">

    <div *ngFor="let item of chiTietHoaDonData" class="invoice-details-item">
      <img [src]="'http://localhost:8080' + item.anhUrls" alt="{{ item.tenSanPham }}" />
      <div class="invoice-details-info">
        <p><strong>TÃªn Sáº£n Pháº©m:</strong> {{ item.tenSanPham }}</p>
        <p><strong>ÄÆ¡n GiÃ¡:</strong> {{ item.donGia | number }}</p>
        <p><strong>Sá»‘ LÆ°á»£ng:</strong> {{ item.soLuong }}</p>
        <p><strong>ThÃ nh Tiá»n:</strong> {{ item.donGia * item.soLuong | number }} VNÄ</p>
        <p><strong>MÃ u Sáº¯c:</strong> {{ item.mauSac }}</p>
      </div>
    </div>
  </section>

  <!-- Chi tiáº¿t thanh toÃ¡n -->
  <section class="section">
    <h3>Chi tiáº¿t thanh toÃ¡n</h3>
    <p><strong>Tá»•ng tiá»n trÆ°á»›c voucher:</strong> {{ hoaDonData.tongTienTruocVoucher | number }} VNÄ</p>
    <!-- Äiá»u kiá»‡n hiá»ƒn thá»‹ voucher vÃ  giÃ¡ trá»‹ giáº£m -->
    <div *ngIf="hoaDonData.voucher">
      <p><strong>TÃªn voucher:</strong> {{ hoaDonData.voucher?.ten }}</p>

      <!-- Hiá»ƒn thá»‹ giÃ¡ trá»‹ giáº£m náº¿u voucher giáº£m pháº§n trÄƒm -->
      <p *ngIf="hoaDonData.voucher?.hinhThucGiam === false"><strong>Giáº£m giÃ¡:</strong> {{ hoaDonData.voucher?.giaTriGiam
        + '%' }}</p>

      <!-- Hiá»ƒn thá»‹ giÃ¡ trá»‹ giáº£m náº¿u voucher giáº£m tiá»n -->
      <p *ngIf="hoaDonData.voucher?.hinhThucGiam === true"><strong>Giáº£m giÃ¡:</strong> {{ hoaDonData.voucher?.giaTriGiam
        + ' VNÄ' }}</p>

      <!-- áº¨n "Giáº£m tá»‘i Ä‘a" náº¿u giáº£m tiá»n -->
      <p *ngIf="hoaDonData.voucher?.hinhThucGiam === false"><strong>Giáº£m tá»‘i Ä‘a:</strong> {{
        hoaDonData.voucher?.giamToiDa }} VNÄ</p>
    </div>

     <!-- Chá»‰ hiá»ƒn thá»‹ náº¿u tráº¡ng thÃ¡i = 5 -->
     <p *ngIf="hoaDonData?.trangThai === 5 && hoaDonData?.ghiChu">
      <strong>LÃ½ do há»§y:</strong> {{ hoaDonData.ghiChu }}
    </p>
    
    <!-- Náº¿u khÃ´ng cÃ³ voucher thÃ¬ khÃ´ng hiá»ƒn thá»‹ thÃ´ng tin voucher -->
    <p *ngIf="!hoaDonData.voucher"><strong>HÃ³a Ä‘Æ¡n khÃ´ng Ã¡p dá»¥ng voucher</strong></p>
    <p><strong>TÃªn phÆ°Æ¡ng thá»©c:</strong> {{ hoaDonData.phuongThucThanhToan?.ten }}</p>
    <p><strong>PhÃ­ váº­n chuyá»ƒn:</strong> {{ hoaDonData.phiVanChuyen | number }} VNÄ</p>
    <p><strong>Tá»•ng tiá»n thanh toÃ¡n:</strong> {{ hoaDonData.tongTienThanhToan | number }} VNÄ</p>
  </section>

  <!-- NÃºt Há»§y vÃ  NÃºt Quay Vá» Trang Chá»§ -->
  <div class="button-container">
    <!-- NÃºt há»§y -->
<button *ngIf="hoaDonData.trangThai != 5" (click)="openCancelModal()" class="btn btn-danger">
  Há»§y HÃ³a ÄÆ¡n
</button>

<!-- Modal nháº­p lÃ½ do há»§y -->
<div class="modal-overlay-huy" *ngIf="showCancelModal">
  <div class="modal-huy">
    <h4>Nháº­p lÃ½ do há»§y hÃ³a Ä‘Æ¡n</h4>
    <textarea [(ngModel)]="ghiChu" rows="4" placeholder="Nháº­p lÃ½ do..."></textarea>
    <div class="modal-buttons">
      <button class="btn btn-secondary" (click)="closeCancelModal()">Há»§y</button>
      <button class="btn btn-danger" (click)="cancelHoaDon()">XÃ¡c nháº­n há»§y</button>
    </div>
  </div>
</div>

    <button (click)="goHome()" class="btn btn-primary">Vá» Trang Chá»§</button>
  </div>
</div>



<!-- Náº¿u chÆ°a cÃ³ dá»¯ liá»‡u -->
<ng-template #noData>
  <!-- <p>ChÆ°a cÃ³ dá»¯ liá»‡u hÃ³a Ä‘Æ¡n Ä‘á»ƒ hiá»ƒn thá»‹.</p> -->
</ng-template>